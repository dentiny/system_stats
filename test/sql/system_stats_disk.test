# name: test/sql/system_stats_disk.test
# description: test sys_disk_info function
# group: [sql]

# Require statement will ensure this test is run with this extension loaded
require system_stats

# Test sys_disk_info function returns at least one row
query I
SELECT COUNT(*) >= 1 FROM sys_disk_info();
----
true

# Test sys_disk_info function with unit='GB'
query I
SELECT COUNT(*) >= 1 FROM sys_disk_info(unit='GB');
----
true

# Test sys_disk_info function with unit='MiB'
query I
SELECT COUNT(*) >= 1 FROM sys_disk_info(unit='MiB');
----
true

# Test sys_disk_info function with invalid unit
statement error
SELECT * FROM sys_disk_info(unit='invalid');
----
Invalid unit 'invalid'. Supported units: bytes, KB, KiB, MB, MiB, GB, GiB, TB, TiB

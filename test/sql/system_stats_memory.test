# name: test/sql/system_stats_memory.test
# description: test sys_memory_info function
# group: [sql]

# Require statement will ensure this test is run with this extension loaded
require system_stats

# Test sys_memory_info function
query IIIIIII
SELECT 
    total_memory > 0,
    used_memory > 0,
    free_memory >= 0,
    cached_memory >= 0,
    total_swap >= 0,
    used_swap >= 0,
    free_swap >= 0
FROM sys_memory_info();
----
true	true	true	true	true	true	true

# Test sys_memory_info function with unit='MB' (decimal)
query IIIIIII
SELECT 
    total_memory > 0,
    used_memory > 0,
    free_memory >= 0,
    cached_memory >= 0,
    total_swap >= 0,
    used_swap >= 0,
    free_swap >= 0
FROM sys_memory_info(unit='MB');
----
true	true	true	true	true	true	true

# Test sys_memory_info function with unit='GiB'
query IIIIIII
SELECT 
    total_memory > 0,
    used_memory > 0,
    free_memory >= 0,
    cached_memory >= 0,
    total_swap >= 0,
    used_swap >= 0,
    free_swap >= 0
FROM sys_memory_info(unit='GiB');
----
true	true	true	true	true	true	true

# Test sys_memory_info function with invalid unit
statement error
SELECT * FROM sys_memory_info(unit='invalid');
----
Invalid unit 'invalid'. Supported units: bytes, KB, KiB, MB, MiB, GB, GiB, TB, TiB

# name: test/sql/system_stats_memory.test
# description: test sys_memory_info function
# group: [sql]

# Require statement will ensure this test is run with this extension loaded
require system_stats

# Test sys_memory_info function
query IIIIIII
SELECT 
    total_memory > 0,
    used_memory > 0,
    free_memory >= 0,
    cached_memory >= 0,
    total_swap >= 0,
    used_swap >= 0,
    free_swap >= 0
FROM sys_memory_info();
----
true	true	true	true	true	true	true

# Test that all memory values are numeric and not null
query I
SELECT COUNT(*) FROM sys_memory_info()
WHERE total_memory IS NOT NULL
  AND used_memory IS NOT NULL
  AND free_memory IS NOT NULL
  AND cached_memory IS NOT NULL
  AND total_swap IS NOT NULL
  AND used_swap IS NOT NULL
  AND free_swap IS NOT NULL;
----
1
